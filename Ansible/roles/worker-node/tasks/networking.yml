---
- name: Add head node IP to known hosts
  template: src=etc/ssh/shosts.equiv.j2 dest=/etc/ssh/shosts.equiv owner=root group=root mode=644
#  debug: msg="created shosts.equiv file"
  tags: 
  - networking

- name: Add head node public key to worker node
  template: src=etc/ssh/ssh_known_hosts.j2  dest=/etc/ssh/ssh_known_hosts owner=root group=root mode=644
  tags: 
  - networking
  
- name: Enable host-based authentication
  lineinfile: dest=/etc/ssh/sshd_config regexp="^#HostbasedAuthentication no" line="HostbasedAuthentication yes"
  notify: 
  - restart ssh

#- name: Set worker node hostname
#  hostname: {{ item }}.{{ site_domain }} 
