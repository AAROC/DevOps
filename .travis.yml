language: bash
cache:
  directories:
    - ansible
   
before_install:
  - sudo apt-get install traceroute
  - sudo cat /etc/resolv.conf
  - sudo chmod 666 /run/resolvconf/resolv.conf
  - sudo ls -lht /run/resolvconf/resolv.conf
  - sudo echo "nameserver 8.8.8.8" >> /run/resolvconf/resolv.conf
  - traceroute 212.189.145.20
  - git clone https://github.com/ansible/ansible.git --recursive
  - sudo apt-get install python
  - cd ansible/
  - source ./hacking/env-setup
  - sudo python setup.py install

install:
  - traceroute vm01.ct.infn.it
  - traceroute vm03.ct.infn.it
  - cd $TRAVIS_BUILD_DIR/Ansible
  - chmod 400 $PWD/roles/bootstrap/files/public_keys/*
#  - ansible-playbook -vvvv -i inventories/inventory.identity.dev -C idp-ldap.yml --private-key=$PWD/roles/bootstrap/files/public_keys/id_rsa.pub.becker.serbaggio
  - ansible all -i inventories/inventory.identity.dev --private-key=$PWD/roles/bootstrap/files/public_keys/id_rsa.pub.becker.serbaggio -m ping
