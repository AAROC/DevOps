---
version: '2'
settings:
  vars_files: 
    - db.yml
  conductor:
    base: centos:7
  project_name: apel
services:
  db:
    hostname: db
    from: mysql
    ports: 
      - 3306:3306
    environment:
      - "MYSQL_ROOT_PASSWORD={{ db_root_password }}"
    command: ['mysqld']
  server:
    hostname: server
    from: centos/systemd
    ports:
      - 6163:6163
    command: ['/usr/sbin/init']
    depends_on: 
      - db
    roles:
      - { role: AAROC.certificates, needs_certificate: false }
      - { role: AAROC.regional-apel-server }
  
registries:
  quay:
    url: https://quay.io
    namespace: aaroc