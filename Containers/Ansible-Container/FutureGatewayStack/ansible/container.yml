# We have three containers for the Future Gateway :
# 1. api-server - the container exposing the flask application which accepts job submission from the application
#    executes python (flask)
# 2. gridengine - SAGA-enabled web application running in tomcat, communicating with the computational backend.
#    executes java (tomcat)
# 3. db - persistent storage for the event engine.
#    executes mysql server

version: "1"
services:
  api-server:
    image: "aaroc/future-gateway-api-server:centos6"
    ports:
      - "8888:8888"
    working_dir: /tmp/fgapiserver
    command: ['python','fgapiserver.py']
  db:
     image: "mysql"
     ports:
       - "3306:3306"
     environment:
       MYSQL_ROOT_PASSWORD: "{{ db_root_password }}"
       MYSQL_USER: "{{ api_db_username }}"
       MYSQL_PASSWORD: "{{ api_db_userpass}}"
     volumes:
       - "/tmp/fgapi-server-db-data/:/var/lib/mysql"
  tomcat:
    image: 'tomcat:7'
    ports:
      - 8080:8080
registries: {}
